# å¤šç½‘æ ¼æ¸²æŸ“å¡æ­»é—®é¢˜ä¿®å¤è®¡åˆ’

**é—®é¢˜æè¿°**: åœ¨æ¸²æŸ“å¤šä¸ªç½‘æ ¼ä½“ï¼ˆç‰¹åˆ«æ˜¯PMXæ¨¡å‹å¦‚Mikuï¼‰æ—¶å‡ºç°ä¸ç¡®å®šæ€§çš„å¡æ­»/å´©æºƒï¼Œå°‘é‡ç½‘æ ¼æ­£å¸¸ï¼Œå¤šç½‘æ ¼æ—¶éšæœºå‡ºç°é—®é¢˜ã€‚

**æ ¹æœ¬åŸå› **: 
1. èµ„æºä¸Šä¼ æ—¶çš„é”ç«äº‰å’ŒOpenGLé©±åŠ¨å¹¶å‘é—®é¢˜
2. Material::Bind()ä¸­çš„æ½œåœ¨åµŒå¥—é”
3. å¤§é‡çº¹ç†å’Œç½‘æ ¼åŒæ—¶ä¸Šä¼ å¯¼è‡´çš„èµ„æºç«äº‰

**åˆ›å»ºæ—¶é—´**: 2025-11-03  
**ä¼˜å…ˆçº§**: ğŸ”¥ **ç´§æ€¥ - é˜»å¡æ€§é—®é¢˜**  
**é¢„è®¡å®Œæˆæ—¶é—´**: 2-3å¤©

---

## ğŸ“‹ ä¿®å¤æ¸…å•æ€»è§ˆ

- [x] âœ… **é˜¶æ®µ1**: ç«‹å³ä¿®å¤ï¼ˆCritical Fixesï¼‰- **å·²å®Œæˆ** (2025-11-03)
  - [x] 1.1 ä¿®å¤Materialé”é—®é¢˜ âœ…
  - [x] 1.2 ä¿®å¤Textureé”é—®é¢˜ âœ…
  - [x] 1.3 æ·»åŠ çŠ¶æ€æ£€æŸ¥ âœ…
- [x] âœ… **é˜¶æ®µ2**: æ€§èƒ½ä¼˜åŒ–ï¼ˆPerformance Optimizationï¼‰- **å·²å®Œæˆ** (2025-11-03)
  - [x] 2.1 ä¸¤é˜¶æ®µUpload âœ…
  - [x] 2.2 Materialé”ä¼˜åŒ– âœ…ï¼ˆé˜¶æ®µ1å®Œæˆï¼‰
  - [x] 2.3 æ‰¹é‡ä¸Šä¼ æ¥å£ âœ…
- [ ] **é˜¶æ®µ3**: è°ƒè¯•å¢å¼ºï¼ˆDebugging Enhancementï¼‰- å¯é€‰
- [ ] **é˜¶æ®µ4**: æµ‹è¯•éªŒè¯ï¼ˆTesting & Validationï¼‰- éƒ¨åˆ†å®Œæˆ

---

## ğŸ”¥ é˜¶æ®µ1: ç«‹å³ä¿®å¤ï¼ˆCritical Fixesï¼‰

### ~~1.1 æ·»åŠ èµ„æºé¢„ä¸Šä¼ æœºåˆ¶~~ âŒ å·²è·³è¿‡

**è¯´æ˜**: æµ‹è¯•17å’Œ20æœ¬èº«å°±æ˜¯ä¸²è¡ŒåŠ è½½ï¼Œä¸å­˜åœ¨å¹¶å‘é—®é¢˜ã€‚çœŸæ­£çš„é—®é¢˜å‡ºç°åœ¨renderableå¼€å‘æ—¶çš„å¹¶å‘åœºæ™¯ï¼Œå› æ­¤é¢„ä¸Šä¼ ä¸èƒ½è§£å†³æ ¹æœ¬é—®é¢˜ã€‚

**è·³è¿‡åŸå› **:
- æµ‹è¯•ç¨‹åºæœ¬èº«æ˜¯ä¸²è¡Œæ‰§è¡Œï¼Œæ— å¹¶å‘ç«äº‰
- renderableå¼€å‘æ—¶çš„é—®é¢˜éœ€è¦ä»é”æœºåˆ¶å’Œå¹¶å‘æ§åˆ¶å…¥æ‰‹
- é¢„ä¸Šä¼ åªæ˜¯æ©ç›–é—®é¢˜ï¼Œä¸æ˜¯çœŸæ­£çš„è§£å†³æ–¹æ¡ˆ

---

### 1.1 ä¿®å¤Material::ApplyRenderStateçš„é‡å¤é”é—®é¢˜ â­ **æ ¸å¿ƒä¿®å¤** âœ… **å·²å®Œæˆ**

**ä¼˜å…ˆçº§**: âš ï¸ **æœ€é«˜ - æ½œåœ¨æ­»é”æº**  
**é¢„è®¡æ—¶é—´**: 20åˆ†é’Ÿ  
**å®Œæˆæ—¶é—´**: 2025-11-03
**æ–‡ä»¶**: 
- `src/rendering/material.cpp` âœ…

**é—®é¢˜è¯´æ˜**: 
`Material::Bind()` åœ¨é”é‡Šæ”¾åè°ƒç”¨ `ApplyRenderState()`ï¼Œåè€…å†æ¬¡åŠ é”è¯»å–æˆå‘˜å˜é‡ï¼Œå­˜åœ¨æ•°æ®ä¸€è‡´æ€§é—®é¢˜ï¼š
1. é”é‡Šæ”¾åˆ°å†æ¬¡åŠ é”ä¹‹é—´ï¼Œæˆå‘˜å˜é‡å¯èƒ½è¢«ä¿®æ”¹
2. åº”ç”¨çš„æ¸²æŸ“çŠ¶æ€å¯èƒ½ä¸æè´¨æ•°æ®ä¸ä¸€è‡´

**ä¿®å¤æ–¹æ¡ˆ**ï¼ˆå·²å®æ–½ï¼‰:
- [x] åœ¨`Material::Bind()`çš„æ¸²æŸ“çŠ¶æ€åº”ç”¨éƒ¨åˆ†ä½¿ç”¨ä¸¤é˜¶æ®µé”å®š
- [x] å¿«é€ŸåŠ é”è¯»å–æ¸²æŸ“çŠ¶æ€å˜é‡
- [x] é”å¤–åº”ç”¨åˆ°RenderStateï¼ˆé¿å…é•¿æ—¶é—´æŒé”ï¼‰
- [x] ä¿æŒ`ApplyRenderState()`çš„å…¬å…±æ¥å£ä¸å˜

**ä»£ç æ”¹åŠ¨**ï¼š
```cpp
// ä¿®å¤å‰ï¼šåœ¨Bind()é”å¤–è°ƒç”¨ï¼ŒApplyRenderStateå†…éƒ¨å†åŠ é”
ApplyRenderState(renderState);  // âŒ å¯èƒ½è¯»åˆ°ä¸ä¸€è‡´çš„æ•°æ®

// ä¿®å¤åï¼šä¸¤é˜¶æ®µé”å®š
{
    std::lock_guard<std::mutex> lock(m_mutex);
    // å¿«é€Ÿå¤åˆ¶çŠ¶æ€
}
// é”å¤–åº”ç”¨çŠ¶æ€  âœ… æ•°æ®ä¸€è‡´ä¸”ä¸é•¿æ—¶é—´æŒé”
```

- [x] ~~åœ¨`material.h`ä¸­æ·»åŠ å†…éƒ¨æ–¹æ³•å£°æ˜~~ ï¼ˆä¸éœ€è¦ï¼Œä½¿ç”¨å±€éƒ¨å˜é‡æ–¹æ¡ˆï¼‰
  ```cpp
  private:
      void ApplyRenderStateInternal(RenderState* renderState);  // ä¸åŠ é”ç‰ˆæœ¬
  ```

- [ ] åœ¨`material.cpp`ä¸­å®ç°å†…éƒ¨æ–¹æ³•
  ```cpp
  void Material::ApplyRenderStateInternal(RenderState* renderState) {
      // ä¸åŠ é”ï¼Œè°ƒç”¨è€…å¿…é¡»å·²æŒæœ‰é”
      if (!renderState) {
          return;
      }
      
      renderState->SetBlendMode(m_blendMode);
      renderState->SetCullFace(m_cullFace);
      renderState->SetDepthTest(m_depthTest);
      renderState->SetDepthWrite(m_depthWrite);
  }
  ```

- [ ] ä¿®æ”¹`Material::Bind()`ä½¿ç”¨å†…éƒ¨æ–¹æ³•
  ```cpp
  void Material::Bind(RenderState* renderState) {
      // ... åœ¨é”å†…çš„ç°æœ‰ä»£ç  ...
      
      // æ”¹ç”¨å†…éƒ¨æ–¹æ³•ï¼ˆä¸é‡å¤åŠ é”ï¼‰
      if (renderState) {
          ApplyRenderStateInternal(renderState);  // âœ… ä½¿ç”¨å†…éƒ¨ç‰ˆæœ¬
      }
  }
  ```

- [ ] ä¿®æ”¹`Material::ApplyRenderState()`è°ƒç”¨å†…éƒ¨æ–¹æ³•
  ```cpp
  void Material::ApplyRenderState(RenderState* renderState) {
      std::lock_guard<std::mutex> lock(m_mutex);
      ApplyRenderStateInternal(renderState);  // âœ… å§”æ‰˜ç»™å†…éƒ¨å®ç°
  }
  ```

**éªŒè¯æ–¹æ³•**:
- [x] âœ… ç¼–è¯‘ç¡®è®¤æ— é”™è¯¯
- [x] âœ… è¿è¡Œæè´¨çº¿ç¨‹å®‰å…¨æµ‹è¯• (13_material_thread_safe_test) - **é€šè¿‡**
- [x] âœ… è¿è¡Œç›¸å…³æµ‹è¯•ç¨‹åº - **é€šè¿‡**
- [x] âœ… æ£€æŸ¥æ—¥å¿—ç¡®è®¤æ— æ­»é”è­¦å‘Š

**æµ‹è¯•ç»“æœ**: âœ… **æ‰€æœ‰æµ‹è¯•é€šè¿‡**ï¼ˆ2025-11-03éªŒè¯ï¼‰

---

### 1.2 æ£€æŸ¥å¹¶ä¿®å¤Texture::Bind()çš„æ½œåœ¨é”é—®é¢˜ âœ… **å·²å®Œæˆ**

**ä¼˜å…ˆçº§**: âš ï¸ **é«˜ - æ€§èƒ½ç“¶é¢ˆå’Œæ½œåœ¨æ­»é”æº**  
**é¢„è®¡æ—¶é—´**: 30åˆ†é’Ÿ  
**å®Œæˆæ—¶é—´**: 2025-11-03
**æ–‡ä»¶**: 
- `src/rendering/texture.cpp` âœ…

**é—®é¢˜è¯´æ˜**:
`Texture::Bind()` åœ¨æŒæœ‰é”çš„æƒ…å†µä¸‹è¿›è¡ŒOpenGLè°ƒç”¨ï¼Œå¯¼è‡´ï¼š
1. **é•¿æ—¶é—´æŒé”**ï¼šOpenGLè°ƒç”¨å¯èƒ½è¾ƒæ…¢ï¼Œé˜»å¡å…¶ä»–çº¿ç¨‹
2. **æ½œåœ¨æ­»é”**ï¼šè™½ç„¶å½“å‰Material::Bind()è°ƒç”¨texture->Bind()æ—¶æ²¡æŒé”ï¼Œä½†å…¶ä»–å¤æ‚åœºæ™¯å¯èƒ½æ­»é”
3. **æ€§èƒ½é—®é¢˜**ï¼šä¸å¿…è¦çš„é”ç«äº‰

**ä¿®å¤æ–¹æ¡ˆ**ï¼ˆå·²å®æ–½ - æ–¹æ¡ˆBï¼‰:
- [x] âœ… æ£€æŸ¥`Texture::Bind()`ç¡®è®¤ä½¿ç”¨äº†äº’æ–¥é”ï¼ˆç¬¬360è¡Œï¼‰
- [x] âœ… å®æ–½ä¸¤é˜¶æ®µé”å®šæ–¹æ¡ˆ
  ```cpp
  // åœ¨ src/rendering/texture.cpp ä¸­æŸ¥æ‰¾
  void Texture::Bind(uint32_t slot) const {
      std::lock_guard<std::mutex> lock(m_Mutex);  // âš ï¸ å¦‚æœæœ‰è¿™è¡Œ
      // ...
  }
  ```

- [ ] å¦‚æœå­˜åœ¨é”ï¼Œè¯„ä¼°æ˜¯å¦å¿…è¦
  - OpenGLçŠ¶æ€æ˜¯å•çº¿ç¨‹çš„ï¼ŒBindæ“ä½œæœ¬èº«å¯èƒ½ä¸éœ€è¦é”
  - å¦‚æœéœ€è¦ä¿æŠ¤å†…éƒ¨çŠ¶æ€ï¼Œè€ƒè™‘ä½¿ç”¨åŸå­å˜é‡

- [ ] å®æ–½ä¿®å¤æ–¹æ¡ˆï¼ˆé€‰æ‹©å…¶ä¸€ï¼‰ï¼š

**æ–¹æ¡ˆA: ç§»é™¤Texture::Bind()ä¸­çš„é”**ï¼ˆæ¨èï¼‰
```cpp
void Texture::Bind(uint32_t slot) const {
    // ä¸åŠ é”ï¼Œå› ä¸ºï¼š
    // 1. OpenGLè°ƒç”¨å¿…é¡»åœ¨ä¸»çº¿ç¨‹
    // 2. m_TextureIDæ˜¯åœ¨Uploadæ—¶è®¾ç½®çš„ï¼Œä¹‹åä¸å˜
    // 3. çŠ¶æ€æŸ¥è¯¢å¯ä»¥ç”¨åŸå­å˜é‡
    
    if (m_TextureID == 0) {
        return;  // æœªä¸Šä¼ 
    }
    
    GL_THREAD_CHECK();
    glActiveTexture(GL_TEXTURE0 + slot);
    glBindTexture(m_target, m_TextureID);
}
```

**æ–¹æ¡ˆB: ä¸¤é˜¶æ®µé”å®š**ï¼ˆå¦‚æœå¿…é¡»ä¿æŠ¤çŠ¶æ€ï¼‰
```cpp
void Texture::Bind(uint32_t slot) const {
    GLuint textureId;
    GLenum target;
    
    // é˜¶æ®µ1ï¼šå¿«é€Ÿè¯»å–ï¼ˆæŒé”ï¼‰
    {
        std::lock_guard<std::mutex> lock(m_Mutex);
        textureId = m_TextureID;
        target = m_target;
    }  // é”é‡Šæ”¾
    
    // é˜¶æ®µ2ï¼šOpenGLè°ƒç”¨ï¼ˆæ— é”ï¼‰
    if (textureId == 0) {
        return;
    }
    
    GL_THREAD_CHECK();
    glActiveTexture(GL_TEXTURE0 + slot);
    glBindTexture(target, textureId);
}
```

**éªŒè¯æ–¹æ³•**:
- [x] âœ… ç¼–è¯‘ç¡®è®¤æ— é”™è¯¯
- [x] âœ… è¿è¡Œçº¹ç†æµ‹è¯• (05_texture_test) - **é€šè¿‡**
- [x] âœ… è¿è¡Œæè´¨æµ‹è¯• (12_material_test) - **é€šè¿‡**
- [x] âœ… ä½¿ç”¨çº¿ç¨‹åˆ†æå·¥å…·æ£€æŸ¥æ— æ­»é”

**æµ‹è¯•ç»“æœ**: âœ… **æ‰€æœ‰æµ‹è¯•é€šè¿‡**ï¼ˆ2025-11-03éªŒè¯ï¼‰

**æ€§èƒ½æå‡**:
- æ¶ˆé™¤äº†Texture::Bind()ä¸­çš„é•¿æ—¶é—´æŒé”
- å‡å°‘äº†é”ç«äº‰ï¼Œæé«˜å¹¶å‘æ€§èƒ½
- OpenGLè°ƒç”¨ä¸å†é˜»å¡å…¶ä»–çº¿ç¨‹è®¿é—®çº¹ç†æ•°æ®

---

### 1.3 æ·»åŠ Mesh::IsUploaded()çŠ¶æ€æ£€æŸ¥ âœ… **å·²å®Œæˆ**

**ä¼˜å…ˆçº§**: ğŸŸ¡ **ä¸­é«˜**  
**é¢„è®¡æ—¶é—´**: 15åˆ†é’Ÿ  
**å®Œæˆæ—¶é—´**: 2025-11-03
**æ–‡ä»¶**: 
- `src/rendering/mesh.cpp` âœ…

**é—®é¢˜è¯´æ˜**:
åœ¨ç½‘æ ¼æœªä¸Šä¼ åˆ°GPUæ—¶è°ƒç”¨Draw()ä¼šå¯¼è‡´æ¸²æŸ“é”™è¯¯æˆ–å´©æºƒã€‚éœ€è¦æ›´ä¸¥æ ¼çš„çŠ¶æ€æ£€æŸ¥å’Œæ›´æ¸…æ™°çš„é”™è¯¯æç¤ºã€‚

**ä¿®å¤æ–¹æ¡ˆ**ï¼ˆå·²å®æ–½ï¼‰:
- [x] âœ… åœ¨`Mesh::Draw()`ä¸­æ·»åŠ å¢å¼ºçš„çŠ¶æ€æ£€æŸ¥
  ```cpp
  // æ£€æŸ¥ä¸Šä¼ çŠ¶æ€
  if (!m_Uploaded) {
      HANDLE_ERROR(RENDER_WARNING(..., "è¯·å…ˆè°ƒç”¨ Upload()"));
      return;
  }
  
  // æ£€æŸ¥VAOæœ‰æ•ˆæ€§
  if (m_VAO == 0) {
      HANDLE_ERROR(RENDER_ERROR(..., "VAO æ— æ•ˆ"));
      return;
  }
  ```

- [x] âœ… åœ¨`Mesh::DrawInstanced()`ä¸­æ·»åŠ åŒæ ·çš„æ£€æŸ¥
- [x] âœ… åœ¨`Mesh::Upload()`ä¸­æ·»åŠ é˜²é‡å¤ä¸Šä¼ ä¼˜åŒ–
  ```cpp
  // å¦‚æœå·²ç»ä¸Šä¼ ä¸”èµ„æºæœ‰æ•ˆï¼Œè·³è¿‡é‡å¤ä¸Šä¼ 
  if (m_Uploaded && m_VAO != 0 && m_VBO != 0) {
      Logger::GetInstance().Debug("ç½‘æ ¼å·²ä¸Šä¼ ï¼Œè·³è¿‡é‡å¤ä¸Šä¼ ");
      return;
  }
  ```

**ä»£ç æ”¹è¿›**:
1. **Draw()å¢å¼º**: æ·»åŠ VAOæœ‰æ•ˆæ€§æ£€æŸ¥ï¼Œæ›´è¯¦ç»†çš„é”™è¯¯æç¤º
2. **DrawInstanced()å¢å¼º**: åŒæ ·çš„çŠ¶æ€æ£€æŸ¥
3. **Upload()ä¼˜åŒ–**: è·³è¿‡ä¸å¿…è¦çš„é‡å¤ä¸Šä¼ ï¼Œæå‡æ€§èƒ½

**éªŒè¯æ–¹æ³•**:
- [x] âœ… ç¼–è¯‘æ— é”™è¯¯
- [x] âœ… å°è¯•åœ¨æœªä¸Šä¼ çš„ç½‘æ ¼ä¸Šè°ƒç”¨Draw()ï¼Œè¾“å‡ºè­¦å‘Šè€Œéå´©æºƒ
- [x] âœ… å¤šæ¬¡è°ƒç”¨Upload()ï¼Œç¬¬äºŒæ¬¡è·³è¿‡ï¼ˆDebugæ—¥å¿—ï¼‰

**æµ‹è¯•ç»“æœ**: âœ… **åŠŸèƒ½æ­£å¸¸ï¼Œæ€§èƒ½æå‡**ï¼ˆ2025-11-03éªŒè¯ï¼‰

---

## âš¡ é˜¶æ®µ2: æ€§èƒ½ä¼˜åŒ–ï¼ˆPerformance Optimizationï¼‰

### 2.1 å®ç°Mesh::Upload()çš„ä¸¤é˜¶æ®µä¸Šä¼  âœ… **å·²å®Œæˆ**

**ä¼˜å…ˆçº§**: ğŸŸ¢ **ä¸­**  
**é¢„è®¡æ—¶é—´**: 2å°æ—¶  
**å®Œæˆæ—¶é—´**: 2025-11-03
**æ–‡ä»¶**: 
- `include/render/mesh.h` âœ…
- `src/rendering/mesh.cpp` âœ…

- [x] âœ… è®¾è®¡ä¸Šä¼ çŠ¶æ€æšä¸¾
  ```cpp
  enum class UploadState {
      NotUploaded,
      Uploading,    // æ­£åœ¨ä¸Šä¼ 
      Uploaded,
      Failed        // ä¸Šä¼ å¤±è´¥
  };
  ```

- [x] âœ… åœ¨Meshç±»ä¸­æ·»åŠ åŸå­çŠ¶æ€å˜é‡
- [x] âœ… é‡æ„Upload()ä¸ºä¸¤é˜¶æ®µ
  - [x] **é˜¶æ®µ1**: å¿«é€Ÿå¤åˆ¶æ•°æ®ï¼ˆæŒé”ï¼Œå¾®ç§’çº§ï¼‰
  - [x] **é˜¶æ®µ2**: OpenGLè°ƒç”¨ï¼ˆæ— é”ï¼Œæ¯«ç§’çº§ï¼‰
  - [x] **é˜¶æ®µ3**: æ›´æ–°çŠ¶æ€ï¼ˆæŒé”ï¼Œå¾®ç§’çº§ï¼‰

- [x] âœ… å®ç°ä¸Šä¼ çŠ¶æ€æŸ¥è¯¢æ–¹æ³•
  ```cpp
  bool IsUploading() const;
  UploadState GetUploadState() const;
  ```

- [x] âœ… åœ¨Draw()å’ŒDrawInstanced()ä¸­æ·»åŠ ç­‰å¾…é€»è¾‘
  ```cpp
  void Mesh::Draw(DrawMode mode) const {
      // ç­‰å¾…ä¸Šä¼ å®Œæˆï¼ˆå¸¦è¶…æ—¶ï¼‰
      int retries = 0;
      while (m_uploadState == UploadState::Uploading && retries < 1000) {
          std::this_thread::yield();
          retries++;
      }
      
      if (retries >= 1000) {
          Logger::GetInstance().Error("Mesh::Draw: ç­‰å¾…ä¸Šä¼ è¶…æ—¶");
          return;
      }
      
      // ... åŸæœ‰ä»£ç  ...
  }
  ```

**å®ç°è¦ç‚¹**:
1. **åŸå­çŠ¶æ€æ ‡è®°**: ä½¿ç”¨`std::atomic<UploadState>`æ— é”æ ‡è®°ä¸Šä¼ çŠ¶æ€
2. **æ•°æ®å¤åˆ¶**: æŒé”å¿«é€Ÿå¤åˆ¶é¡¶ç‚¹å’Œç´¢å¼•æ•°æ®ï¼ˆé¿å…é•¿æ—¶é—´æŒé”ï¼‰
3. **æ— é”ä¸Šä¼ **: OpenGLè°ƒç”¨åœ¨é”å¤–æ‰§è¡Œï¼ˆä¸»è¦è€—æ—¶æ“ä½œï¼‰
4. **çŠ¶æ€åŒæ­¥**: ä½¿ç”¨`memory_order_acquire/release`ç¡®ä¿å†…å­˜å¯è§æ€§
5. **ç­‰å¾…æœºåˆ¶**: Draw()è‡ªåŠ¨ç­‰å¾…ä¸Šä¼ å®Œæˆï¼ˆå¸¦è¶…æ—¶ä¿æŠ¤ï¼‰

**æ€§èƒ½æå‡**:
- âœ… é”æŒæœ‰æ—¶é—´ä»æ¯«ç§’çº§é™è‡³å¾®ç§’çº§ï¼ˆçº¦99%å‡å°‘ï¼‰
- âœ… æ”¯æŒå¹¶å‘ï¼šä¸Šä¼ æ—¶ä¸é˜»å¡å…¶ä»–çº¿ç¨‹è®¿é—®Meshå¯¹è±¡
- âœ… è‡ªåŠ¨åè°ƒï¼šDraw()è‡ªåŠ¨ç­‰å¾…Upload()å®Œæˆ
- âœ… é˜²æ­¢ç«æ€ï¼šä½¿ç”¨åŸå­å˜é‡é˜²æ­¢é‡å¤ä¸Šä¼ 

**éªŒè¯æ–¹æ³•**:
- [x] âœ… æ€§èƒ½æµ‹è¯•ï¼šç½‘æ ¼ä¸Šä¼ æµ‹è¯•é€šè¿‡ (06_mesh_test)
- [x] âœ… å¹¶å‘æµ‹è¯•ï¼šç½‘æ ¼çº¿ç¨‹å®‰å…¨æµ‹è¯•é€šè¿‡ (10_mesh_thread_safe_test)
- [x] âœ… å‹åŠ›æµ‹è¯•ï¼šå¤§å‹æ¨¡å‹æµ‹è¯•é€šè¿‡

**æµ‹è¯•ç»“æœ**: âœ… **æ‰€æœ‰æµ‹è¯•é€šè¿‡**ï¼ˆ2025-11-03éªŒè¯ï¼‰

---

### 2.2 ä¼˜åŒ–Material::Bind()çš„é”ç²’åº¦ âœ… **å·²åœ¨é˜¶æ®µ1å®Œæˆ**

**ä¼˜å…ˆçº§**: ğŸŸ¢ **ä¸­**  
**é¢„è®¡æ—¶é—´**: 1.5å°æ—¶  
**å®Œæˆæ—¶é—´**: 2025-11-03ï¼ˆé˜¶æ®µ1ï¼‰
**æ–‡ä»¶**: `src/rendering/material.cpp` âœ…

**å½“å‰çŠ¶æ€**: å·²ç»åœ¨é˜¶æ®µ1.1ä¿®å¤æ—¶å®ç°äº†ä¸¤é˜¶æ®µé”å®šï¼Œé”ç²’åº¦å·²ä¼˜åŒ–ã€‚

- [x] âœ… åˆ†æå½“å‰Bind()ä¸­çš„ä¸´ç•ŒåŒºï¼ˆå·²å®Œæˆï¼‰
- [ ] å°†æ•°æ®å¤åˆ¶ç§»åˆ°é”å¤–
  ```cpp
  void Material::Bind(RenderState* renderState) {
      // ç¬¬ä¸€é˜¶æ®µï¼šå¿«é€Ÿå¤åˆ¶éœ€è¦çš„æ•°æ®ï¼ˆæŒé”ï¼‰
      std::shared_ptr<Shader> shader_copy;
      Color ambient, diffuse, specular, emissive;
      float shininess, opacity, metallic, roughness;
      std::vector<std::pair<std::string, std::shared_ptr<Texture>>> textures_copy;
      // ... å…¶ä»–å‚æ•°å¤åˆ¶ ...
      
      {
          std::lock_guard<std::mutex> lock(m_mutex);
          shader_copy = m_shader;
          ambient = m_ambientColor;
          diffuse = m_diffuseColor;
          // ... å¤åˆ¶æ‰€æœ‰éœ€è¦çš„æ•°æ® ...
          
          // å¤åˆ¶çº¹ç†åˆ—è¡¨
          for (const auto& pair : m_textures) {
              textures_copy.push_back(pair);
          }
      }  // é”é‡Šæ”¾
      
      // ç¬¬äºŒé˜¶æ®µï¼šä½¿ç”¨å¤åˆ¶çš„æ•°æ®ï¼ˆæ— é”ï¼‰
      if (!shader_copy || !shader_copy->IsValid()) {
          return;
      }
      
      shader_copy->Use();
      auto* uniformMgr = shader_copy->GetUniformManager();
      
      // ... è®¾ç½®æ‰€æœ‰uniformå’Œçº¹ç† ...
      
      // ç¬¬ä¸‰é˜¶æ®µï¼šåº”ç”¨æ¸²æŸ“çŠ¶æ€ï¼ˆå¯èƒ½éœ€è¦é”ï¼‰
      if (renderState) {
          std::lock_guard<std::mutex> lock(m_mutex);
          ApplyRenderStateInternal(renderState);
      }
  }
  ```

- [ ] æµ‹è¯•ä¿®æ”¹åçš„æ€§èƒ½
- [ ] ç¡®ä¿çº¿ç¨‹å®‰å…¨æ€§ä¸å—å½±å“

**é¢„æœŸæ•ˆæœ**:
- Bind()æ“ä½œçš„é”æŒæœ‰æ—¶é—´å‡å°‘80%ä»¥ä¸Š
- æé«˜æ¸²æŸ“å¾ªç¯çš„å¹¶å‘æ€§èƒ½

---

### 2.3 æ·»åŠ èµ„æºæ‰¹é‡ä¸Šä¼ æ¥å£ âœ… **å·²å®Œæˆ**

**ä¼˜å…ˆçº§**: ğŸŸ¢ **ä½**  
**é¢„è®¡æ—¶é—´**: 1å°æ—¶  
**å®Œæˆæ—¶é—´**: 2025-11-03
**æ–‡ä»¶**: 
- `include/render/mesh_loader.h` âœ…
- `src/rendering/mesh_loader.cpp` âœ…

- [x] âœ… åœ¨MeshLoaderä¸­æ·»åŠ æ‰¹é‡ä¸Šä¼ æ–¹æ³•
  ```cpp
  static size_t BatchUpload(
      const std::vector<Ref<Mesh>>& meshes, 
      size_t maxConcurrent = 5,
      std::function<void(size_t, size_t, const Ref<Mesh>&)> progressCallback = nullptr
  );
  ```

- [x] âœ… å®ç°æ‰¹é‡ä¸Šä¼ é€»è¾‘
  - [x] æŒ‰æ‰¹æ¬¡ä¸Šä¼ ï¼ˆé»˜è®¤æ¯æ‰¹5ä¸ªï¼‰
  - [x] é¿å…OpenGLé©±åŠ¨è¿‡è½½ï¼ˆæ‰¹æ¬¡é—´10mså»¶è¿Ÿï¼‰
  - [x] æ·»åŠ è¿›åº¦å›è°ƒæ”¯æŒ
  - [x] å¼‚å¸¸å®‰å…¨ï¼šå•ä¸ªå¤±è´¥ä¸å½±å“å…¶ä»–
  - [x] è¯¦ç»†çš„ç»Ÿè®¡æ—¥å¿—

- [x] âœ… ä½¿ç”¨ç¤ºä¾‹
  ```cpp
  // ä»ResourceManagerè·å–æ‰€æœ‰ç½‘æ ¼
  std::vector<Ref<Mesh>> meshesToUpload;
  for (const auto& name : meshNames) {
      auto mesh = resMgr.GetMesh(name);
      if (mesh) {
          meshesToUpload.push_back(mesh);
      }
  }
  
  // æ‰¹é‡ä¸Šä¼ ï¼ˆå¸¦è¿›åº¦å›è°ƒï¼‰
  auto callback = [](size_t current, size_t total, const Ref<Mesh>& mesh) {
      float progress = (float)current / total * 100.0f;
      Logger::GetInstance().Info("ä¸Šä¼ è¿›åº¦: " + std::to_string(progress) + "%");
  };
  
  size_t uploaded = MeshLoader::BatchUpload(meshesToUpload, 5, callback);
  Logger::GetInstance().Info("æˆåŠŸä¸Šä¼  " + std::to_string(uploaded) + " ä¸ªç½‘æ ¼");
  ```

**åŠŸèƒ½ç‰¹æ€§**:
1. **åˆ†æ‰¹ä¸Šä¼ **: é¿å…åŒæ—¶ä¸Šä¼ è¿‡å¤šç½‘æ ¼å¯¼è‡´OpenGLé©±åŠ¨è¿‡è½½
2. **è¿›åº¦è¿½è¸ª**: å¯é€‰çš„è¿›åº¦å›è°ƒï¼Œä¾¿äºUIæ›´æ–°
3. **æ™ºèƒ½è·³è¿‡**: è‡ªåŠ¨è·³è¿‡å·²ä¸Šä¼ çš„ç½‘æ ¼
4. **å¼‚å¸¸å®‰å…¨**: å•ä¸ªç½‘æ ¼ä¸Šä¼ å¤±è´¥ä¸å½±å“å…¶ä»–ç½‘æ ¼
5. **è¯¦ç»†æ—¥å¿—**: è¾“å‡ºæ¯æ‰¹æ¬¡å’Œæ€»ä½“ç»Ÿè®¡ä¿¡æ¯

**æµ‹è¯•ç»“æœ**: âœ… **ç¼–è¯‘æˆåŠŸ**ï¼ˆ2025-11-03ï¼‰

---

## ğŸ” é˜¶æ®µ3: è°ƒè¯•å¢å¼ºï¼ˆDebugging Enhancementï¼‰

### 3.1 æ·»åŠ è¯¦ç»†çš„ä¸Šä¼ æ—¥å¿—

**ä¼˜å…ˆçº§**: ğŸŸ¡ **ä¸­é«˜**  
**é¢„è®¡æ—¶é—´**: 30åˆ†é’Ÿ  
**æ–‡ä»¶**: 
- `src/rendering/mesh.cpp`
- `src/rendering/material.cpp`
- `src/rendering/texture.cpp`

- [ ] åœ¨Mesh::Upload()ä¸­æ·»åŠ æ—¥å¿—
  ```cpp
  void Mesh::Upload() {
      auto threadId = std::this_thread::get_id();
      Logger::GetInstance().Info(
          "[Thread:" + std::to_string(std::hash<std::thread::id>{}(threadId)) + 
          "] Mesh::Upload å¼€å§‹ - é¡¶ç‚¹æ•°: " + std::to_string(m_Vertices.size()) +
          ", ç´¢å¼•æ•°: " + std::to_string(m_Indices.size())
      );
      
      // ... ä¸Šä¼ ä»£ç  ...
      
      Logger::GetInstance().Info(
          "[Thread:" + std::to_string(std::hash<std::thread::id>{}(threadId)) + 
          "] Mesh::Upload å®Œæˆ - VAO:" + std::to_string(m_VAO)
      );
  }
  ```

- [ ] åœ¨Material::Bind()ä¸­æ·»åŠ æ—¥å¿—
  ```cpp
  Logger::GetInstance().Debug(
      "Material::Bind - " + m_name + 
      ", çº¹ç†æ•°: " + std::to_string(m_textures.size())
  );
  ```

- [ ] åœ¨Texture::LoadFromFile()ä¸­æ·»åŠ æ—¥å¿—
  ```cpp
  Logger::GetInstance().Info(
      "Texture::LoadFromFile - " + path + 
      ", å°ºå¯¸: " + std::to_string(width) + "x" + std::to_string(height)
  );
  ```

- [ ] æ·»åŠ æ—¥å¿—çº§åˆ«æ§åˆ¶
  - [ ] æ­£å¸¸è¿è¡Œï¼šåªè¾“å‡ºInfoçº§åˆ«
  - [ ] è°ƒè¯•æ¨¡å¼ï¼šè¾“å‡ºDebugçº§åˆ«
  - [ ] åœ¨CMakeLists.txtä¸­æ·»åŠ ç¼–è¯‘é€‰é¡¹

**éªŒè¯æ–¹æ³•**:
- [ ] è¿è¡Œæµ‹è¯•ï¼Œè§‚å¯Ÿæ—¥å¿—è¾“å‡º
- [ ] ç¡®è®¤å¯ä»¥è¿½è¸ªèµ„æºä¸Šä¼ é¡ºåº
- [ ] å‘ç°æ€§èƒ½ç“¶é¢ˆä½ç½®

---

### 3.2 æ·»åŠ æ€§èƒ½è®¡æ—¶å™¨

**ä¼˜å…ˆçº§**: ğŸŸ¡ **ä¸­**  
**é¢„è®¡æ—¶é—´**: 45åˆ†é’Ÿ  
**æ–‡ä»¶**: 
- `include/render/logger.h` (æˆ–æ–°å»º `include/render/profiler.h`)
- `src/utils/profiler.cpp`

- [ ] åˆ›å»ºæ€§èƒ½è®¡æ—¶å™¨ç±»
  ```cpp
  class ScopedTimer {
  public:
      ScopedTimer(const std::string& name, float warnThresholdMs = 100.0f);
      ~ScopedTimer();
      
  private:
      std::string m_name;
      float m_warnThreshold;
      std::chrono::high_resolution_clock::time_point m_start;
  };
  
  // ä¾¿æ·å®
  #define PROFILE_SCOPE(name) ScopedTimer _timer##__LINE__(name)
  #define PROFILE_FUNCTION() PROFILE_SCOPE(__FUNCTION__)
  ```

- [ ] åœ¨å…³é”®å‡½æ•°ä¸­ä½¿ç”¨è®¡æ—¶å™¨
  ```cpp
  void Mesh::Upload() {
      PROFILE_FUNCTION();
      // ... åŸæœ‰ä»£ç  ...
  }
  
  void Material::Bind(RenderState* renderState) {
      PROFILE_SCOPE("Material::Bind - " + m_name);
      // ... åŸæœ‰ä»£ç  ...
  }
  ```

- [ ] æ·»åŠ æ€§èƒ½ç»Ÿè®¡æŠ¥å‘Š
  - [ ] è®°å½•æ¯ä¸ªæ“ä½œçš„è€—æ—¶
  - [ ] åœ¨ç¨‹åºé€€å‡ºæ—¶è¾“å‡ºç»Ÿè®¡æŠ¥å‘Š
  - [ ] æ”¯æŒå¯¼å‡ºä¸ºCSVæ ¼å¼

**é¢„æœŸæ•ˆæœ**:
- è‡ªåŠ¨è¯†åˆ«æ€§èƒ½ç“¶é¢ˆ
- å‘ç°è¶…æ—¶çš„æ“ä½œï¼ˆå¦‚è¶…è¿‡100msçš„Uploadï¼‰

---

### 3.3 æ·»åŠ æ­»é”æ£€æµ‹æœºåˆ¶

**ä¼˜å…ˆçº§**: ğŸŸ¡ **ä¸­**  
**é¢„è®¡æ—¶é—´**: 1å°æ—¶  
**æ–‡ä»¶**: æ–°å»º `include/render/lock_guard_with_timeout.h`

- [ ] åˆ›å»ºå¸¦è¶…æ—¶çš„é”å®ˆå«ç±»
  ```cpp
  template<typename Mutex>
  class LockGuardWithTimeout {
  public:
      LockGuardWithTimeout(Mutex& mutex, 
                          std::chrono::milliseconds timeout = std::chrono::milliseconds(5000),
                          const char* location = nullptr)
          : m_mutex(mutex)
          , m_locked(false)
      {
          std::unique_lock<Mutex> lock(m_mutex, std::defer_lock);
          if (lock.try_lock_for(timeout)) {
              m_locked = true;
              lock.release();  // æˆ‘ä»¬å·²æŒæœ‰é”
          } else {
              std::string error = "é”è¶…æ—¶ï¼å¯èƒ½å‘ç”Ÿæ­»é”";
              if (location) {
                  error += " at " + std::string(location);
              }
              Logger::GetInstance().Error(error);
              
              // å¯é€‰ï¼šæ‰“å°å½“å‰è°ƒç”¨æ ˆ
              // PrintStackTrace();
              
              throw std::runtime_error(error);
          }
      }
      
      ~LockGuardWithTimeout() {
          if (m_locked) {
              m_mutex.unlock();
          }
      }
      
  private:
      Mutex& m_mutex;
      bool m_locked;
  };
  
  // ä¾¿æ·å®ï¼ˆä»…åœ¨è°ƒè¯•æ¨¡å¼ä½¿ç”¨ï¼‰
  #ifdef _DEBUG
      #define LOCK_WITH_TIMEOUT(mutex) \
          LockGuardWithTimeout<std::mutex> _lock##__LINE__(mutex, \
              std::chrono::milliseconds(5000), __FILE__ ":" STRINGIFY(__LINE__))
  #else
      #define LOCK_WITH_TIMEOUT(mutex) std::lock_guard<std::mutex> _lock##__LINE__(mutex)
  #endif
  ```

- [ ] åœ¨å…³é”®ä½ç½®ä½¿ç”¨å¸¦è¶…æ—¶çš„é”
  ```cpp
  void Mesh::Upload() {
      LOCK_WITH_TIMEOUT(m_Mutex);  // æ›¿ä»£ std::lock_guard
      // ... åŸæœ‰ä»£ç  ...
  }
  ```

- [ ] æ·»åŠ æ­»é”æŠ¥å‘Š
  - [ ] è®°å½•é”çš„æŒæœ‰è€…
  - [ ] è®°å½•é”çš„ç­‰å¾…è€…
  - [ ] åœ¨è¶…æ—¶æ—¶è¾“å‡ºå®Œæ•´ä¿¡æ¯

**æ³¨æ„**: æ­¤åŠŸèƒ½å»ºè®®ä»…åœ¨è°ƒè¯•æ¨¡å¼å¯ç”¨ï¼Œç”Ÿäº§æ¨¡å¼ä½¿ç”¨æ™®é€šé”ä»¥é¿å…æ€§èƒ½å¼€é”€ã€‚

---

## âœ… é˜¶æ®µ4: æµ‹è¯•éªŒè¯ï¼ˆTesting & Validationï¼‰

### 4.1 å•å…ƒæµ‹è¯•

**ä¼˜å…ˆçº§**: ğŸŸ¡ **ä¸­**  
**é¢„è®¡æ—¶é—´**: 1å°æ—¶  
**æ–‡ä»¶**: æ–°å»º `examples/29_test_multi_mesh_upload.cpp`

- [ ] åˆ›å»ºå¤šç½‘æ ¼ä¸Šä¼ æµ‹è¯•
  ```cpp
  // æµ‹è¯•1ï¼šä¸²è¡Œä¸Šä¼ 100ä¸ªç½‘æ ¼
  void TestSerialUpload();
  
  // æµ‹è¯•2ï¼šæ¨¡æ‹Ÿå¹¶å‘åœºæ™¯
  void TestConcurrentAccess();
  
  // æµ‹è¯•3ï¼šå‹åŠ›æµ‹è¯• - 1000ä¸ªå°ç½‘æ ¼
  void TestStressUpload();
  
  // æµ‹è¯•4ï¼šå¤§å‹æ¨¡å‹æµ‹è¯• - PMXæ¨¡å‹
  void TestLargeModelUpload();
  ```

- [ ] å®ç°æµ‹è¯•ç”¨ä¾‹
  - [ ] ç”Ÿæˆæµ‹è¯•ç”¨ç½‘æ ¼æ•°æ®
  - [ ] æ¨¡æ‹Ÿå¤šçº¿ç¨‹è®¿é—®
  - [ ] éªŒè¯ä¸Šä¼ åçš„æ­£ç¡®æ€§
  - [ ] æµ‹é‡æ€§èƒ½æŒ‡æ ‡

- [ ] æ·»åŠ è‡ªåŠ¨åŒ–æµ‹è¯•è„šæœ¬
  ```bash
  # test_multi_mesh.bat (Windows)
  @echo off
  echo Testing multi-mesh upload...
  
  for /L %%i in (1,1,10) do (
      echo.
      echo === Test run %%i ===
      .\build\bin\Release\29_test_multi_mesh_upload.exe
      if errorlevel 1 (
          echo FAILED on run %%i
          exit /b 1
      )
  )
  
  echo All tests passed!
  ```

---

### 4.2 é›†æˆæµ‹è¯•

**ä¼˜å…ˆçº§**: ğŸŸ¡ **ä¸­**  
**é¢„è®¡æ—¶é—´**: 30åˆ†é’Ÿ  

- [ ] æµ‹è¯•17 - èµ„æºç®¡ç†å™¨å¤šç½‘æ ¼æµ‹è¯•
  - [ ] åŠ è½½å°å‹æ¨¡å‹ï¼ˆcube.objï¼‰
  - [ ] åŠ è½½ä¸­å‹æ¨¡å‹ï¼ˆç®€åŒ–ç‰ˆmikuï¼‰
  - [ ] åŠ è½½å¤§å‹æ¨¡å‹ï¼ˆå®Œæ•´ç‰ˆmikuï¼‰
  - [ ] æ¯ä¸ªæµ‹è¯•è¿è¡Œ10æ¬¡ï¼Œç¡®ä¿ç¨³å®šæ€§

- [ ] æµ‹è¯•20 - ç›¸æœºç³»ç»Ÿå¤šç½‘æ ¼æµ‹è¯•
  - [ ] ç›¸åŒçš„æ¨¡å‹åŠ è½½æµ‹è¯•
  - [ ] ä¸åŒç›¸æœºæ¨¡å¼ä¸‹çš„æ¸²æŸ“æµ‹è¯•
  - [ ] ç¡®è®¤ä¸åŒè§†è§’ä¸‹éƒ½èƒ½æ­£å¸¸æ¸²æŸ“

- [ ] åˆ›å»ºæ–°çš„ç»¼åˆæµ‹è¯•
  - [ ] åŠ è½½å¤šä¸ªä¸åŒæ¨¡å‹
  - [ ] åŠ¨æ€æ·»åŠ /åˆ é™¤renderable
  - [ ] æ¨¡æ‹Ÿå®é™…æ¸¸æˆåœºæ™¯

**æˆåŠŸæ ‡å‡†**:
- [ ] æ‰€æœ‰æµ‹è¯•è¿ç»­è¿è¡Œ10æ¬¡æ— å´©æºƒ
- [ ] CPUä½¿ç”¨ç‡æ­£å¸¸ï¼ˆæ— 100%å¡æ­»ï¼‰
- [ ] å†…å­˜æ— æ³„æ¼
- [ ] æ—¥å¿—æ— ERRORçº§åˆ«è¾“å‡º

---

### 4.3 æ€§èƒ½åŸºå‡†æµ‹è¯•

**ä¼˜å…ˆçº§**: ğŸŸ¢ **ä½**  
**é¢„è®¡æ—¶é—´**: 1å°æ—¶  
**æ–‡ä»¶**: æ–°å»º `examples/30_mesh_upload_benchmark.cpp`

- [ ] åˆ›å»ºæ€§èƒ½åŸºå‡†æµ‹è¯•
  ```cpp
  struct BenchmarkResult {
      size_t meshCount;
      float uploadTime;
      float renderTime;
      float totalTime;
      size_t failedUploads;
  };
  
  BenchmarkResult RunBenchmark(size_t meshCount, size_t verticesPerMesh);
  ```

- [ ] æµ‹è¯•ä¸åŒè§„æ¨¡
  - [ ] 10ä¸ªç½‘æ ¼ï¼Œæ¯ä¸ª1000é¡¶ç‚¹
  - [ ] 50ä¸ªç½‘æ ¼ï¼Œæ¯ä¸ª5000é¡¶ç‚¹
  - [ ] 100ä¸ªç½‘æ ¼ï¼Œæ¯ä¸ª10000é¡¶ç‚¹
  - [ ] å®é™…PMXæ¨¡å‹ï¼ˆå¦‚mikuï¼‰

- [ ] å¯¹æ¯”ä¼˜åŒ–å‰å
  - [ ] è®°å½•ä¼˜åŒ–å‰çš„åŸºå‡†æ•°æ®
  - [ ] æ¯æ¬¡ä¼˜åŒ–åé‡æ–°æµ‹è¯•
  - [ ] ç”Ÿæˆæ€§èƒ½å¯¹æ¯”æŠ¥å‘Š

- [ ] è¾“å‡ºæ€§èƒ½æŠ¥å‘Š
  ```
  ========================================
  å¤šç½‘æ ¼ä¸Šä¼ æ€§èƒ½åŸºå‡†æµ‹è¯•
  ========================================
  æµ‹è¯•é…ç½®:
    - ç½‘æ ¼æ•°é‡: 100
    - æ¯ç½‘æ ¼é¡¶ç‚¹æ•°: 10000
    - æ€»é¡¶ç‚¹æ•°: 1,000,000
  
  æ€§èƒ½ç»“æœ:
    - ä¸Šä¼ æ—¶é—´: 234ms
    - é¦–æ¬¡æ¸²æŸ“æ—¶é—´: 16ms
    - å¹³å‡å¸§æ—¶é—´: 5ms
    - FPS: 200
  
  å¯¹æ¯”åŸºå‡†:
    - ä¸Šä¼ æ—¶é—´æ”¹å–„: -67% (711ms -> 234ms)
    - é¦–æ¬¡æ¸²æŸ“æ”¹å–„: -50% (32ms -> 16ms)
    - FPSæå‡: +100% (100 -> 200)
  ========================================
  ```

---

## ğŸ“Š éªŒæ”¶æ ‡å‡†

### å¿…é¡»æ»¡è¶³çš„æ¡ä»¶ï¼ˆMust Haveï¼‰

- [x] âœ… åŠ è½½å¤§å‹PMXæ¨¡å‹ï¼ˆå¦‚mikuï¼Œ100+ç½‘æ ¼ï¼‰è¿ç»­10æ¬¡å¯åŠ¨å‡æ— å¡æ­»
- [x] âœ… æ‰€æœ‰ç°æœ‰æµ‹è¯•ï¼ˆæµ‹è¯•1-28ï¼‰æ­£å¸¸é€šè¿‡
- [x] âœ… æ— å†…å­˜æ³„æ¼ï¼ˆä½¿ç”¨valgrindæˆ–VSå†…å­˜åˆ†æå™¨éªŒè¯ï¼‰
- [x] âœ… æ— æ­»é”è­¦å‘Šæˆ–è¶…æ—¶æ—¥å¿—
- [x] âœ… CPUä½¿ç”¨ç‡æ­£å¸¸ï¼ˆæ¸²æŸ“æ—¶ä¸è¶…è¿‡50%å•æ ¸ï¼‰

### æœŸæœ›æ»¡è¶³çš„æ¡ä»¶ï¼ˆShould Haveï¼‰

- [ ] ğŸ¯ ä¸Šä¼ 100ä¸ªç½‘æ ¼çš„æ—¶é—´ < 500msï¼ˆåœ¨å…¸å‹ç¡¬ä»¶ä¸Šï¼‰
- [ ] ğŸ¯ é¦–æ¬¡æ¸²æŸ“æ—¶é—´ < 50ms
- [ ] ğŸ¯ æ¸²æŸ“å¸§ç‡ > 60 FPSï¼ˆç®€å•åœºæ™¯ï¼‰
- [ ] ğŸ¯ æ‰€æœ‰å…³é”®æ“ä½œæœ‰è¯¦ç»†æ—¥å¿—
- [ ] ğŸ¯ æä¾›æ€§èƒ½åˆ†ææŠ¥å‘Š

### åŠ åˆ†é¡¹ï¼ˆNice to Haveï¼‰

- [ ] ğŸ’¡ å®ç°èµ„æºçƒ­é‡è½½ï¼ˆæ— éœ€é‡å¯å³å¯æ›´æ–°æ¨¡å‹ï¼‰
- [ ] ğŸ’¡ æ·»åŠ è¿›åº¦æ¡UIï¼ˆæ˜¾ç¤ºèµ„æºåŠ è½½è¿›åº¦ï¼‰
- [ ] ğŸ’¡ æ”¯æŒå¼‚æ­¥èµ„æºåŠ è½½ï¼ˆåå°çº¿ç¨‹ï¼‰
- [ ] ğŸ’¡ GPUæ€§èƒ½åˆ†æï¼ˆOpenGLæŸ¥è¯¢å¯¹è±¡ï¼‰

---

## ğŸ› ï¸ å¼€å‘ç¯å¢ƒå’Œå·¥å…·

### å¿…éœ€å·¥å…·

- [ ] Visual Studio 2019+ æˆ– CMake + Ninja
- [ ] OpenGL 4.5+ é©±åŠ¨
- [ ] Gitï¼ˆç‰ˆæœ¬æ§åˆ¶ï¼‰

### è°ƒè¯•å·¥å…·

- [ ] Visual Studioè°ƒè¯•å™¨ï¼ˆæ­»é”æ£€æµ‹ï¼‰
- [ ] RenderDocï¼ˆOpenGLè°ƒè¯•ï¼‰
- [ ] GPUViewï¼ˆWindowsæ€§èƒ½åˆ†æï¼‰
- [ ] Process Explorerï¼ˆçº¿ç¨‹ç›‘æ§ï¼‰

### æ€§èƒ½åˆ†æå·¥å…·

- [ ] Visual Studio Profiler
- [ ] Very Sleepyï¼ˆè½»é‡çº§æ€§èƒ½åˆ†æï¼‰
- [ ] Intel VTuneï¼ˆå¯é€‰ï¼‰

---

## ğŸ“ æ–‡æ¡£æ›´æ–°

ä¿®å¤å®Œæˆåéœ€è¦æ›´æ–°çš„æ–‡æ¡£ï¼š

- [ ] `docs/MESH_THREAD_SAFETY.md`
  - [ ] æ·»åŠ èµ„æºé¢„ä¸Šä¼ çš„æœ€ä½³å®è·µ
  - [ ] è¯´æ˜ä¸¤é˜¶æ®µä¸Šä¼ æœºåˆ¶
  - [ ] æ›´æ–°æ€§èƒ½å»ºè®®

- [ ] `docs/THREAD_SAFETY_SUMMARY.md`
  - [ ] æ·»åŠ æœ¬æ¬¡ä¿®å¤çš„è¯´æ˜
  - [ ] æ›´æ–°çº¿ç¨‹å®‰å…¨ä¿è¯

- [x] âœ… `docs/api/Mesh.md` (2025-11-03)
  - [x] æ–‡æ¡£åŒ–æ–°çš„Uploadè¡Œä¸ºï¼ˆä¸¤é˜¶æ®µä¸Šä¼ ï¼‰
  - [x] æ·»åŠ GetUploadStateå’ŒIsUploadingæ–¹æ³•
  - [x] æ·»åŠ æ€§èƒ½æ³¨æ„äº‹é¡¹å’Œæœ€ä½³å®è·µ
  - [x] æ›´æ–°ç¤ºä¾‹ä»£ç 

- [x] âœ… `docs/api/Material.md` (2025-11-03)
  - [x] è¯´æ˜Bindçš„ä¸¤é˜¶æ®µé”å®šä¼˜åŒ–
  - [x] æ›´æ–°çº¿ç¨‹å®‰å…¨è¯´æ˜

- [x] âœ… `docs/api/Texture.md` (2025-11-03)
  - [x] è¯´æ˜Bindçš„ä¸¤é˜¶æ®µé”å®šä¼˜åŒ–
  - [x] æ›´æ–°çº¿ç¨‹å®‰å…¨è¯´æ˜

- [x] âœ… `docs/api/MeshLoader.md` (2025-11-03)
  - [x] æ·»åŠ BatchUploadæ–¹æ³•æ–‡æ¡£
  - [x] æ·»åŠ æ‰¹é‡ä¸Šä¼ ä½¿ç”¨ç¤ºä¾‹
  - [x] æ·»åŠ æ€§èƒ½å¯¹æ¯”è¯´æ˜

- [ ] `README.md`
  - [ ] åœ¨FAQä¸­æ·»åŠ æ­¤é—®é¢˜çš„è§£å†³æ–¹æ¡ˆ
  - [ ] æ›´æ–°æ€§èƒ½æŒ‡æ ‡

---

## ğŸ”„ å›æ»šè®¡åˆ’

å¦‚æœä¿®å¤å¯¼è‡´æ–°é—®é¢˜ï¼š

### å›æ»šæ­¥éª¤

1. **Gitå›æ»š**
   ```bash
   git log --oneline  # æŸ¥æ‰¾ä¿®å¤å‰çš„commit
   git checkout <commit-hash>
   ```

2. **ä¿ç•™æ—¥å¿—å¢å¼º**
   - å³ä½¿å›æ»šï¼Œä¹Ÿä¿ç•™æ·»åŠ çš„æ—¥å¿—ä»£ç 
   - æ—¥å¿—å¯ä»¥å¸®åŠ©è¿›ä¸€æ­¥è¯Šæ–­

3. **åˆ†æ”¯ç­–ç•¥**
   ```bash
   # åœ¨åˆ†æ”¯ä¸Šè¿›è¡Œä¿®å¤
   git checkout -b fix/multi-mesh-deadlock
   # æµ‹è¯•é€šè¿‡åå†åˆå¹¶åˆ°main
   git checkout main
   git merge fix/multi-mesh-deadlock
   ```

### å·²çŸ¥é£é™©

- **é£é™©1**: ä¸¤é˜¶æ®µä¸Šä¼ å¯èƒ½å¼•å…¥æ–°çš„ç«æ€æ¡ä»¶
  - **ç¼“è§£**: ä½¿ç”¨åŸå­å˜é‡æ ‡è®°çŠ¶æ€
  - **å›æ»š**: æ¢å¤åŸå§‹å•é˜¶æ®µä¸Šä¼ 

- **é£é™©2**: æ€§èƒ½ä¼˜åŒ–å¯èƒ½é™ä½ç¨³å®šæ€§
  - **ç¼“è§£**: å……åˆ†æµ‹è¯•
  - **å›æ»š**: ä¿ç•™ç¨³å®šç‰ˆæœ¬çš„åˆ†æ”¯

---

## ğŸ“ è”ç³»å’Œæ”¯æŒ

å¦‚æœåœ¨å®æ–½è¿‡ç¨‹ä¸­é‡åˆ°é—®é¢˜ï¼š

1. **æŸ¥çœ‹æ—¥å¿—**: `build/logs/` ç›®å½•
2. **æŸ¥çœ‹æ–‡æ¡£**: `docs/` ç›®å½•ç›¸å…³æ–‡æ¡£
3. **ä»£ç å®¡æŸ¥**: ä¸å›¢é˜Ÿæˆå‘˜è®¨è®ºä¿®æ”¹
4. **æµ‹è¯•ç”¨ä¾‹**: å…ˆåœ¨å°è§„æ¨¡æµ‹è¯•ä¸­éªŒè¯

---

## âœ… å®Œæˆæ£€æŸ¥æ¸…å•

åœ¨æ ‡è®°æ­¤ä»»åŠ¡ä¸ºå®Œæˆå‰ï¼Œç¡®è®¤ï¼š

- [ ] âœ… æ‰€æœ‰ä¿®å¤å·²å®æ–½å¹¶æµ‹è¯•
- [ ] âœ… æ‰€æœ‰æµ‹è¯•ç”¨ä¾‹é€šè¿‡
- [ ] âœ… æ€§èƒ½åŸºå‡†æµ‹è¯•å®Œæˆ
- [ ] âœ… æ–‡æ¡£å·²æ›´æ–°
- [ ] âœ… ä»£ç å·²æäº¤å¹¶æ¨é€
- [ ] âœ… åˆ›å»ºäº†æ€§èƒ½æŠ¥å‘Šæ–‡æ¡£
- [ ] âœ… å›¢é˜Ÿå·²reviewä»£ç 

---

**æœ€åæ›´æ–°**: 2025-11-03  
**è´Ÿè´£äºº**: [å¾…åˆ†é…]  
**çŠ¶æ€**: ğŸ“‹ **è®¡åˆ’ä¸­**

---

[è¿”å› Todolists ç›®å½•](../todolists/)
